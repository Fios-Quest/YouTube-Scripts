<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Tests - IRISS Scripts</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon-de23e50b.svg">
        <link rel="shortcut icon" href="../favicon-8114d1fc.png">
        <link rel="stylesheet" href="../css/variables-8adf115d.css">
        <link rel="stylesheet" href="../css/general-2459343d.css">
        <link rel="stylesheet" href="../css/chrome-ae938929.css">
        <link rel="stylesheet" href="../css/print-9e4910d8.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../fonts/fonts-9644e21d.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="mdbook-highlight-css" href="../highlight-493f70e1.css">
        <link rel="stylesheet" id="mdbook-tomorrow-night-css" href="../tomorrow-night-4c0ae647.css">
        <link rel="stylesheet" id="mdbook-ayu-highlight-css" href="../ayu-highlight-3fdfc3ac.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "../searchindex-0cc144a0.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc-cc4b049f.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>‚Üê</kbd> or <kbd>‚Üí</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="mdbook-body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="mdbook-sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("mdbook-sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="mdbook-sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="mdbook-sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="mdbook-page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="mdbook-menu-bar-hover-placeholder"></div>
                <div id="mdbook-menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="mdbook-sidebar-toggle" class="icon-button" for="mdbook-sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="mdbook-sidebar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/></svg></span>
                        </label>
                        <button id="mdbook-theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="mdbook-theme-list">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M371.3 367.1c27.3-3.9 51.9-19.4 67.2-42.9L600.2 74.1c12.6-19.5 9.4-45.3-7.6-61.2S549.7-4.4 531.1 9.6L294.4 187.2c-24 18-38.2 46.1-38.4 76.1L371.3 367.1zm-19.6 25.4l-116-104.4C175.9 290.3 128 339.6 128 400c0 3.9 .2 7.8 .6 11.6c1.8 17.5-10.2 36.4-27.8 36.4H96c-17.7 0-32 14.3-32 32s14.3 32 32 32H240c61.9 0 112-50.1 112-112c0-2.5-.1-5-.2-7.5z"/></svg></span>
                        </button>
                        <ul id="mdbook-theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mdbook-theme-ayu">Ayu</button></li>
                        </ul>
                        <button id="mdbook-search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="mdbook-searchbar">
                            <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352c79.5 0 144-64.5 144-144s-64.5-144-144-144S64 128.5 64 208s64.5 144 144 144z"/></svg></span>
                        </button>
                    </div>

                    <h1 class="menu-title">IRISS Scripts</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <span class=fa-svg id="print-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M128 0C92.7 0 64 28.7 64 64v96h64V64H354.7L384 93.3V160h64V93.3c0-17-6.7-33.3-18.7-45.3L400 18.7C388 6.7 371.7 0 354.7 0H128zM384 352v32 64H128V384 368 352H384zm64 32h32c17.7 0 32-14.3 32-32V256c0-35.3-28.7-64-64-64H64c-35.3 0-64 28.7-64 64v96c0 17.7 14.3 32 32 32H64v64c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V384zm-16-88c-13.3 0-24-10.7-24-24s10.7-24 24-24s24 10.7 24 24s-10.7 24-24 24z"/></svg></span>
                        </a>

                    </div>
                </div>

                <div id="mdbook-search-wrapper" class="hidden">
                    <form id="mdbook-searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="mdbook-searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="mdbook-searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <span class=fa-svg id="fa-spin"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M304 48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zm0 416c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM48 304c26.5 0 48-21.5 48-48s-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48zm464-48c0-26.5-21.5-48-48-48s-48 21.5-48 48s21.5 48 48 48s48-21.5 48-48zM142.9 437c18.7-18.7 18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zm0-294.2c18.7-18.7 18.7-49.1 0-67.9S93.7 56.2 75 75s-18.7 49.1 0 67.9s49.1 18.7 67.9 0zM369.1 437c18.7 18.7 49.1 18.7 67.9 0s18.7-49.1 0-67.9s-49.1-18.7-67.9 0s-18.7 49.1 0 67.9z"/></svg></span>
                            </div>
                        </div>
                    </form>
                    <div id="mdbook-searchresults-outer" class="searchresults-outer hidden">
                        <div id="mdbook-searchresults-header" class="searchresults-header"></div>
                        <ul id="mdbook-searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('mdbook-sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('mdbook-sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#mdbook-sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="mdbook-content" class="content">
                    <main>
                        <h1 id="tests"><a class="header" href="#tests">Tests</a></h1>
<p>Tests. Are. Awesome.</p>
<p>They‚Äôre my favourite bit of software engineering.</p>
<p>I‚Äôm sure many of you can relate, but I don‚Äôt tend to trust humans telling me I‚Äôm doing my job well.</p>
<p>When a computer tells me I‚Äôm doing well at my job because I made a test pass though, oh that dopamine hits good.</p>
<p>A good test makes sure that the thing we‚Äôre building does what we think it should do.</p>
<p>This series has a free accompanying book, in which you can find all the details for this tutorial, check the description below.</p>
<p>My name is Daniel, welcome to IRISS.</p>
<h2 id="intro"><a class="header" href="#intro">Intro</a></h2>
<p>Anecdotally I recently interviewed at a company where I professed my love of tests, and they told me flatly they don‚Äôt write tests, they ‚Äúmove fast‚Äù.</p>
<p>Later in the interview they admitted they were having morale issues because their engineers were constantly getting called out of hours to fix things.</p>
<p>So, it begs the question: are you moving fast if you have to keep going back to fix your old code?</p>
<p>Software engineers are not paid to write software, we‚Äôre paid to solve problems.</p>
<p>Tests are what make sure we solved the right problem and by automating our tests we make sure we don‚Äôt accidentally ‚Äúunsolve‚Äù it further down the line.</p>
<h2 id="the-testing-pyramid"><a class="header" href="#the-testing-pyramid">The testing Pyramid</a></h2>
<p>There are many ways to test software, these largely fall into three categories that make up what we call the testing pyramid.</p>
<p>It‚Äôs a pyramid to indicate that, although all tests are important, those lower down the pyramid should be laying the foundation for the others.</p>
<p>Not only should you have more of them, but they will provide the greatest feeling of safety and security.</p>
<h3 id="end-to-end-tests"><a class="header" href="#end-to-end-tests">End-to-End Tests</a></h3>
<p>End to End tests are designed to make sure that the user of the software you‚Äôve created can complete full user journeys</p>
<p>For example, can the user open, edit and save a file in a desktop application or can a user add an item to a shopping cart and checkout of an ecommerce store.</p>
<p>End-to-End tests are the slowest form of test and lack depth, but they help add confidence that everything works together.</p>
<h3 id="integration-tests"><a class="header" href="#integration-tests">Integration Tests</a></h3>
<p>Integration tests check that the code you control works correctly with code that your program depends on that you don‚Äôt control.</p>
<p>This would include things like databases or other data stores, web apis, library apis, etc.</p>
<p>Integration tests are also used if your software produces a public API.</p>
<p>Because of the communication component to these tests, these tests are also quite slow but you should use more of them than end-to-end tests.</p>
<h3 id="unit-tests"><a class="header" href="#unit-tests">Unit Tests</a></h3>
<p>Unit tests test a single unit of functionality.</p>
<p>These tests are the simplest and the fastest and should make up the bulk of your testing.</p>
<p>These tests are so important, that it is best practice to write them before you write the code you‚Äôre going to test.</p>
<hr>
<p>For this video series, we‚Äôre only going to cover Unit Tests.</p>
<p>That isn‚Äôt to say that Integration Tests and End-to-End Tests aren‚Äôt important, they absolutely are, and there are many good guides out there.</p>
<p>But, it is to say, that Unit Tests are <em>so</em> important, that they significantly impact how we communicate about Rust code.</p>
<p>This is particularly important for documentation which we‚Äôll talk more about that in the next video.</p>
<h2 id="introduction-to-modules"><a class="header" href="#introduction-to-modules">Introduction to Modules</a></h2>
<p>Unlike many languages, in Rust, tests live with the code that they‚Äôre testing.</p>
<p>To explain this we need to talk about how code in Rust is organised with Modules.</p>
<hr>
<p>A Module is simply a container for other things, functions, type definitions, other modules, etc.</p>
<p>You could think of it like a physical container, though you can nest any number of containers together.</p>
<p>The contents of the module are private to that module unless explicitly marked as public with the <code>pub</code> keyword.</p>
<p>Private items can only be accessed inside that module or its submodules</p>
<hr>
<p>We define a module with the <code>mod</code> keyword and a name. There are then three ways to define what‚Äôs inside that module:</p>
<ol>
<li>With a directory named the same thing as the module which contains the file <code>mod.rs</code></li>
<li>With a file in the same directory named the same thing as the module</li>
<li>Inside curly brackets</li>
</ol>
<hr>
<p>If the module exposes anything publicly, you can then reference those things with the path to the module and the name of the thing you‚Äôre referencing separate by double colons.</p>
<p>Sound familiar?</p>
<p>It should, this is how we‚Äôve been accessing Rust‚Äôs standard library. For example, the <code>stdin</code> function is inside the <code>io</code> module, which itself is available inside the <code>std</code> library module.</p>
<hr>
<p>We access that function using stud :: io:: standard in.</p>
<p>We can also use the <code>use</code> keyword to simplify this a bit, for example, we can ‚Äúuse stud io standard-in‚Äù</p>
<p>Then we can use standard in without having to use the full path to the module each time.</p>
<h2 id="test-modules"><a class="header" href="#test-modules">Test Modules</a></h2>
<p>In Rust, we typically create a test module near the code that is being tested.</p>
<p>Let‚Äôs say we want to test some of the split functions we wrote in the last video.</p>
<hr>
<p>I‚Äôve renamed them a bit, so we can have all of them in the same file.</p>
<p>First we start by creating a module to test these functions in the same file as the functions exist</p>
<hr>
<p>As long as nothing in the <code>tests</code> module is used in your main program it shouldn‚Äôt appear in your final binary, however, this isn‚Äôt good enough.</p>
<p>There‚Äôs a risk we might make a mistake of course, but even without that, the module will still be processed by the compiler in order to do things like type checking.</p>
<p>We only care about this module when we‚Äôre running our tests and Rust provides us a way to tell the compiler that too, the configuration attribute <code>cfg</code>.</p>
<p>Attributes are one of Rusts many meta programming tools which we‚Äôll cover more in the future at increasing difficulty levels.</p>
<hr>
<p>For now, the <code>cfg</code> attribute allows us to tell the Rust Compiler (<code>rustc</code>) <em>when</em> we want to compile something.</p>
<p>There are many, many ways to use conditional compilation, but for tests its pretty simple, we only want the module compiled when we‚Äôre building tests.</p>
<p>The <code>cfg</code> has a ‚Äúpredicate‚Äù to identify this simply called <code>test</code>.</p>
<p>So by adding the <code>cfg</code> attribute with the <code>test</code> predicate, rustc will ignore the module unless its explicitly building the tests.</p>
<h2 id="writing-tests"><a class="header" href="#writing-tests">Writing Tests</a></h2>
<p>Now we‚Äôre ready to write our first test.</p>
<p>A test is simply a function that we mark with another attribute <code>#[test]</code>.</p>
<p>This attribute tells Rust to run this function as part of the test suite when we run <code>cargo test</code>.</p>
<hr>
<p>Here‚Äôs a test that won‚Äôt pass.</p>
<p>The <code>assert!()</code> macro takes either one or two parameters.</p>
<p>The first parameter which is not optional is a boolean value, or something that evaluates to a boolean.</p>
<p>If this boolean is false, then the assertion will cause a panic, and the test will fail.</p>
<hr>
<p>The second, optional parameter allows us to annotate the assertion, which can help us more easily determine which (if any) assertion failed in a test.</p>
<p>This is awesome when we create more thorough tests with more assertions.</p>
<p>You will find that people don‚Äôt use this as much, I‚Äôm guilty of this too, but I do recommend making an effort to describe each specific assertion.</p>
<p>The people you work with, as well as future you, will appreciate the effort.</p>
<hr>
<p>There are three main assert macros:</p>
<ul>
<li><code>assert</code> asserts value is true or panics with optional message</li>
<li><code>assert_eq</code> asserts left is equal to right or panics with optional message</li>
<li><code>assert_ne</code> asserts left is NOT equal to right or panics with optional message</li>
</ul>
<hr>
<p>There are a couple of restrictions with the assert macros.</p>
<p>Values used must implement <code>PartialEq</code> and <code>Debug</code>.</p>
<p>Most built in types already implement both, and we‚Äôll talk about how to implement them for your own types in the Traits video.</p>
<p>To run tests in our project we use <code>cargo test</code>.</p>
<p>When we do that for this test, we should see the this.</p>
<hr>
<p>This top bit is a summary of all the tests, then we get a breakdown of each test that failed.</p>
<p>You can see that we get both the line where the test failed in addition to our failure message.</p>
<p>The line number is why a lot of people skip the message, but it can still be useful to help provide context before we need to look up the line.</p>
<h2 id="testing-our-code"><a class="header" href="#testing-our-code">Testing our code</a></h2>
<p>Let‚Äôs move on to writing our actual tests, we‚Äôll start with <code>split_at</code>.</p>
<p>Before we can write a test, <code>split_at</code> is not part of the <code>tests</code> module, so we need to make it available inside.</p>
<p>We can do that with the <code>use</code> statement in one of two ways, either <code>use super::split_at</code> or <code>use super::*</code>.</p>
<p>The <code>super</code> keyword simply means the module above this one, which for your unit tests should be the module you‚Äôre writing tests for.</p>
<p>We can either bring just the one function in, or we can bring in everything available in that scope.</p>
<p>The idiom here is to <code>use super::*</code> as it will bring in everything that needs testing, and hopefully even if it brings in things you aren‚Äôt using it won‚Äôt pollute the test module too much.</p>
<hr>
<p>With our test, lets use ‚ÄúHello world!‚Äù as the input string,</p>
<p>and we‚Äôll split at 3.</p>
<p>So we can expect the left side of the split to be ‚ÄúHel‚Äù,</p>
<p>and the right side to be ‚Äúlo world!‚Äù</p>
<p>I‚Äôve added some context to our asserts, so we can quickly see if anything went wrong.</p>
<p>When we run <code>cargo test</code>, everything passes, which is great!</p>
<hr>
<p>However, because we‚Äôre working with strings, we should check strings that contain more than just ascii characters.</p>
<p>Let‚Äôs write another test for <code>split_at</code>.</p>
<hr>
<p>This is exactly the same but we‚Äôve used ‚ÄúHello World‚Äù in Japanese‚Ä¶ hopefully, let me know if I got it wrong in the comments.</p>
<p>Now when we run the tests, this test fails.</p>
<hr>
<p>This is where testing gets really nuanced, we need to test our expectations of the behaviour, not that the code did what we programmed it to.</p>
<p>In the test, I wrote that I expect the result to be the first 3 characters, but in the last video, I mentioned this would return a length in bytes.</p>
<p>The Japanese character ‚Äúko‚Äù is 3 bytes in length, which is why it‚Äôs the only character that‚Äôs returned.</p>
<p>If we asked for two bytes instead, the split would fall inside a character and this function would panic and crash our program.</p>
<p>Regardless of that though, from the name <code>split_at</code> I think number of characters is the right behaviour here, so lets fix our function.</p>
<hr>
<p>Don‚Äôt worry too much about this yet, we‚Äôre going to cover iterators in a future video but to explain the fix:</p>
<p><code>.chars()</code> returns an iterator over each character in the string.</p>
<p>We then use <code>.take()</code> to only take (at most) the number of characters we wanted to split at from that first iterator.</p>
<p>We then <code>.map()</code> over each character and get its size in bytes, which turns the character into a usize number.</p>
<p>Finally, we <code>.sum()</code> the iterator which adds every number in the iterator together.</p>
<hr>
<p>This turns the length in chars into a new length in bytes and will be correct regardless of what size in bytes those characters are.</p>
<p>This is now safe to use to create our sub slices as the byte count won‚Äôt fall inside a character.</p>
<p>We no longer need to check the bounds of <code>split_at</code> either, because the maximum size will be the full length of the string even if split_at was longer than the string.</p>
<p>Let‚Äôs rerun our tests‚Ä¶and now this test works too!</p>
<hr>
<p>Let‚Äôs quickly write the tests for <code>split_around</code> and <code>split_around_many</code>.</p>
<p>You‚Äôll notice that these functions already work with multibyte strings.</p>
<p>This is because we‚Äôre looking for the start and end of substrings so we already know that the substrings won‚Äôt happen in the middle of a character.</p>
<p>Now all our tests are working, doesn‚Äôt that feel great!</p>
<p>But‚Ä¶ what if I told you: we just did all of this backwards üò≤</p>
<h2 id="test-driven-development"><a class="header" href="#test-driven-development">Test Driven Development</a></h2>
<p>Hopefully, you‚Äôre eager to write a load of code and then write a load of tests, but wait!</p>
<p>As we alluded to at the beginning of the video, and again halfway through, the point of tests isn‚Äôt to test that your code does what you think it does, it‚Äôs to make sure it does what it‚Äôs supposed to do.</p>
<p>As our <code>split_at</code> function showed, its a good idea to decide what you think that function should do before you write it.</p>
<p>The best way to achieve this is to work out what your code is supposed to do, then write the test, then write the code.</p>
<p>This is called Test Driven Development. Let‚Äôs try it out!</p>
<hr>
<p>We‚Äôll create a function that checks if a given string is a palindrome (a word that‚Äôs the same forwards and backwards).</p>
<p>We‚Äôll start by writing our test.</p>
<p>We‚Äôll check whether the function flags ‚Äúkayak‚Äù and ‚Äúracecar‚Äù as palindromes, and flags ‚Äúwood‚Äù as not a palindrome.</p>
<p>Before we can run the test, Rusts type system won‚Äôt let us compile the program without the function existing.</p>
<p>We don‚Äôt want to write the functionality yet so we‚Äôll create the function header and use the <code>todo!()</code> macro</p>
<p><code>todo()!</code> is a handy little marker that we use to say we are intending to deal with this soon.</p>
<p>It always panics so Rust knows our function doesn‚Äôt need to return anything.</p>
<p>We can run our tests now and see that they fail, lets write the code.</p>
<hr>
<p>Like earlier, we‚Äôll get an iterator for each character in the string.</p>
<p>We‚Äôll clone this iterator and reverse it to get a second iterator that goes backwards through the string.</p>
<p>Again, don‚Äôt worry too much about the hows and whys of iterators yet, just go with it.</p>
<p>We can zip the two iterators together, and ccompare each element inside them.</p>
<p>If every element in each iterator is equal to the other, then the word is the same forwards and backwards.</p>
<p>Now when we run our tests they pass.</p>
<hr>
<p>We can now submit our code to a colleague for review.</p>
<p>[Exit left]</p>
<hr>
<p>[Enter right]</p>
<p>Hi Indra, sorry to interrupt, could you review my code?</p>
<p>Looks good to me but while race car is a palindrome, its two words, not one.</p>
<p>Oh hey, yeah, thanks, be right back</p>
<p>[Exit right]</p>
<hr>
<p>[Enter left]</p>
<p>So lets update our test.</p>
<p>All we need to do is add a space to race car.</p>
<p>Now the test fails again, lets fix it.</p>
<p>We‚Äôll update our first iterator to filter out anything that‚Äôs not alphanumeric.</p>
<p>That‚Äôll deal with whitespace and any other punctuation too.</p>
<p>We only need to update the forward iterator because the effect of the filter is cloned.</p>
<p>Our tests pass again, so lets go back to the review</p>
<p>[Exit left]</p>
<hr>
<p>[Enter right]</p>
<p>Hi Indra, how does it look now?</p>
<p>I should have thought of this earlier, but names like Anna are also Palindromes, you should check for that.</p>
<p>Great idea, thanks!</p>
<p>[Exit right]</p>
<hr>
<p>[Enter left]</p>
<p>Lets update our test again. And again our tests fail, that‚Äôs good! Lets update our code.</p>
<p>Now the obvious thing to do here is to lowercase all of the letters BUT in some languages, an uppercase letter might have multiple lowercase variants depending on how its used.</p>
<p>If we map over each character in the string and lowercase it, we actually get another iterator that contains each possible lowercase letter.</p>
<p>This means we now have an iterator of iterators.</p>
<p>We can get back to an iterator of characters by using the flatten method.</p>
<p>And our tests pass again.</p>
<hr>
<p>This function still isn‚Äôt perfect, honestly, but we‚Äôre going to leave it here.</p>
<p>If you want to keep working on it, its worth looking at diacritics as well as the difference between balanced and unbalanced palindromes.</p>
<p>You may need to rely on external crates for more nuanced control of unicode characters.</p>
<hr>
<p>For Test Driven Development, the main thing I want to emphasize is that at each stage:</p>
<ul>
<li>we think about what we want to achieve</li>
<li>write or modify a test to represent that expectation</li>
<li>then work on the functionality until the test passes</li>
</ul>
<h2 id="how-many-tests"><a class="header" href="#how-many-tests">How many tests?</a></h2>
<p>The perennial of questions when it comes to testing: How many tests should a good test writer write if a good test writer could write good tests?</p>
<p>The important thing here is ‚Äúcoverage‚Äù.</p>
<p>We usually measure coverage by lines.</p>
<p>Each time we run a test, we can look to see if a line was run, if it was we call that ‚Äúcovered‚Äù.</p>
<hr>
<p>Take for example this really silly function.</p>
<p>If we only test this function by giving it a number greater than 0, we‚Äôll only ‚Äúcover‚Äù the line first branch of the <code>if</code>, we miss the fact there is a mistake in the second branch.</p>
<hr>
<p>So what percent coverage should you aim for?</p>
<p>Anecdotally, when I was creating my own API framework in PHP, I decided I wanted to get 100% coverage, that is, every line should have a test that hits it.</p>
<hr>
<p>The very last line that was uncovered was, in it entirety, this.</p>
<p>I wondered if it was worth the effort, decided it was.</p>
<p>The reason this was the last uncovered line was that it was part of a nested <code>if</code>.</p>
<p>I‚Äôd tested what happens if you went into both <code>if</code>s, what happens if you didn‚Äôt go into the first, but not what happens if you went into the first, but not the second.</p>
<hr>
<p>I wrote the test and‚Ä¶ found a bug so severe that I had to rewrite almost a third of the framework.</p>
<p>Should have written the tests first, right?</p>
<p>My personal feelings are that you as an engineer should strive for 100% coverage of your code.</p>
<p>As a manager or engineering lead though, test coverage is a terrible metric.</p>
<p>Test coverage doesn‚Äôt tell you if the test was any good.</p>
<p>If you make arbitrary metrics like this, you‚Äôre not improving code quality, engineers will write tests that meet that metric, but don‚Äôt for-fill the reason we want tests in the first place which is to answer: ‚Äúdoes this code do what we want it to do?‚Äù.</p>
<p>As an engineer, it‚Äôs a matter of pride. Get your code right now, and you won‚Äôt have to deal with it later.</p>
<p>As a leader, make sure your engineers are encouraged to be the best they can.</p>
<p>That means giving them the time to write tests first, giving them access to the resources they need to learn how to write the best tests, etc.</p>
<h2 id="homework"><a class="header" href="#homework">Homework</a></h2>
<p>We‚Äôve already let on how you can solve last chapters homework</p>
<p>We only needed one lifetime to represent the link between the input string slice and the string slices inside our vector.</p>
<hr>
<p>For a cleaner API though you could keep our recursive function private and expose a public function that creates the
vector for us.</p>
<p>Because we have control of the vector in this example we can make sure we create a vector with a capacity that is at least as large as the maximum possible entries in it.</p>
<p>This is useful as when you create a new Vector in Rust it has a default size, and any time you try to add an item to a vector that is already full, Rust will allocate the memory for a new larger vector in the background, copy the data from the old location to the new location, then free the memory in the old location.</p>
<p>This is very time-consuming.</p>
<hr>
<p>For the homework this time, I would like you to write the tests for, and then implement the code for the following requirements in this order:</p>
<ol>
<li>Create a function that will reverse the words in an English sentence.</li>
<li>If the string started with a capital letter, it should still start with a capital after the words are reversed.</li>
<li>If the string starts or ends with whitespace, it should be removed (trimmed) from the returned String.</li>
<li>If the string contains more than one sentence, the function should return an error, though for now, that error can be the unit type.</li>
</ol>
<hr>
<p>Your function will need to allocate memory and should probably have a header like this.</p>
<p>I‚Äôve linked to the documentation for String and Result in the description of the video which should help.</p>
<h1 id="going-forward"><a class="header" href="#going-forward">Going forward</a></h1>
<p>As I mentioned, after this chapter we will be talking about Rust differently.</p>
<p>This will primarily be by using the assert macros to state what a value <em>should</em> be rather than printing it to the screen.</p>
<p>For example, one of our earlier code examples looks like this.</p>
<p>We printed the values of x and y to the screen.</p>
<p>From now on, we‚Äôll write our examples like this, which, now you‚Äôve seen the assert macros is cleaner and easier to understand.</p>
<h1 id="next-time"><a class="header" href="#next-time">Next time</a></h1>
<p>This time we‚Äôve covered one of my favourite Rust features, next time we‚Äôre going to cover my number one favourite: Documentation.</p>
<p>The Documentation tooling in Rust is so good, it‚Äôs going to make you wish every language did the same thing!</p>
<p>If that‚Äôs exciting for you, don‚Äôt forget to like and subscribe.</p>
<p>If you need any help with the homework, please do comment!</p>
<p>I‚Äôll also be setting up a Discord server in the near future so keep an eye out for that!</p>
<p>And I‚Äôll see you next time.</p>
<h1 id="fuzz-to-outake"><a class="header" href="#fuzz-to-outake">Fuzz to outake</a></h1>
<p>Gargi: Who even was that?</p>
<p>Indra: I have no idea‚Ä¶ sounded familiar though.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../iriss/005-iriss.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                            </a>

                            <a rel="next prefetch" href="../iriss/007-iriss.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../iriss/005-iriss.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256 246.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg></span>
                    </a>

                    <a rel="next prefetch" href="../iriss/007-iriss.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"/></svg></span>
                    </a>
            </nav>

        </div>

        <template id=fa-eye><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M288 32c-80.8 0-145.5 36.8-192.6 80.6C48.6 156 17.3 208 2.5 243.7c-3.3 7.9-3.3 16.7 0 24.6C17.3 304 48.6 356 95.4 399.4C142.5 443.2 207.2 480 288 480s145.5-36.8 192.6-80.6c46.8-43.5 78.1-95.4 93-131.1c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C433.5 68.8 368.8 32 288 32zM432 256c0 79.5-64.5 144-144 144s-144-64.5-144-144s64.5-144 144-144s144 64.5 144 144zM288 192c0 35.3-28.7 64-64 64c-11.5 0-22.3-3-31.6-8.4c-.2 2.8-.4 5.5-.4 8.4c0 53 43 96 96 96s96-43 96-96s-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6z"/></svg></span></template>
        <template id=fa-eye-slash><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M38.8 5.1C28.4-3.1 13.3-1.2 5.1 9.2S-1.2 34.7 9.2 42.9l592 464c10.4 8.2 25.5 6.3 33.7-4.1s6.3-25.5-4.1-33.7L525.6 386.7c39.6-40.6 66.4-86.1 79.9-118.4c3.3-7.9 3.3-16.7 0-24.6c-14.9-35.7-46.2-87.7-93-131.1C465.5 68.8 400.8 32 320 32c-68.2 0-125 26.3-169.3 60.8L38.8 5.1zM223.1 149.5C248.6 126.2 282.7 112 320 112c79.5 0 144 64.5 144 144c0 24.9-6.3 48.3-17.4 68.7L408 294.5c5.2-11.8 8-24.8 8-38.5c0-53-43-96-96-96c-2.8 0-5.6 .1-8.4 .4c5.3 9.3 8.4 20.1 8.4 31.6c0 10.2-2.4 19.8-6.6 28.3l-90.3-70.8zm223.1 298L373 389.9c-16.4 6.5-34.3 10.1-53 10.1c-79.5 0-144-64.5-144-144c0-6.9 .5-13.6 1.4-20.2L83.1 161.5C60.3 191.2 44 220.8 34.5 243.7c-3.3 7.9-3.3 16.7 0 24.6c14.9 35.7 46.2 87.7 93 131.1C174.5 443.2 239.2 480 320 480c47.8 0 89.9-12.9 126.2-32.5z"/></svg></span></template>
        <template id=fa-copy><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M502.6 70.63l-61.25-61.25C435.4 3.371 427.2 0 418.7 0H255.1c-35.35 0-64 28.66-64 64l.0195 256C192 355.4 220.7 384 256 384h192c35.2 0 64-28.8 64-64V93.25C512 84.77 508.6 76.63 502.6 70.63zM464 320c0 8.836-7.164 16-16 16H255.1c-8.838 0-16-7.164-16-16L239.1 64.13c0-8.836 7.164-16 16-16h128L384 96c0 17.67 14.33 32 32 32h47.1V320zM272 448c0 8.836-7.164 16-16 16H63.1c-8.838 0-16-7.164-16-16L47.98 192.1c0-8.836 7.164-16 16-16H160V128H63.99c-35.35 0-64 28.65-64 64l.0098 256C.002 483.3 28.66 512 64 512h192c35.2 0 64-28.8 64-64v-32h-47.1L272 448z"/></svg></span></template>
        <template id=fa-play><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></span></template>
        <template id=fa-clock-rotate-left><span class=fa-svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M75 75L41 41C25.9 25.9 0 36.6 0 57.9V168c0 13.3 10.7 24 24 24H134.1c21.4 0 32.1-25.9 17-41l-30.8-30.8C155 85.5 203 64 256 64c106 0 192 86 192 192s-86 192-192 192c-40.8 0-78.6-12.7-109.7-34.4c-14.5-10.1-34.4-6.6-44.6 7.9s-6.6 34.4 7.9 44.6C151.2 495 201.7 512 256 512c141.4 0 256-114.6 256-256S397.4 0 256 0C185.3 0 121.3 28.7 75 75zm181 53c-13.3 0-24 10.7-24 24V256c0 6.4 2.5 12.5 7 17l72 72c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-65-65V152c0-13.3-10.7-24-24-24z"/></svg></span></template>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr-ef4e11c1.min.js"></script>
        <script src="../mark-09e88c2c.min.js"></script>
        <script src="../searcher-c2a407aa.js"></script>

        <script src="../clipboard-1626706a.min.js"></script>
        <script src="../highlight-abc7f01d.js"></script>
        <script src="../book-a0b12cfe.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
